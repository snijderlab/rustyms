#![allow(clippy::missing_panics_doc)]
use std::io::BufReader;

use crate::identification::{test_format, PepNetData, PepNetVersion};

#[test]
fn pepnet() {
    match test_format::<PepNetData>(
        BufReader::new(PEPNET_V1_0.as_bytes()),
        None,
        false,
        true,
        Some(PepNetVersion::PepNet_v1_0),
    ) {
        Ok(n) => assert_eq!(n, 20),
        Err(e) => {
            println!("{e}");
            panic!("Failed identified peptides test");
        }
    }
}

const PEPNET_V1_0: &str = "TITLE	DENOVO	Score	PPM Difference	Positional Score
AAAAA	SLGGLLLKLLLLLLLLDLLLLLLLLLLSGR	0.0000	397079.88	[0.4487191, 0.5919148, 0.21016912, 0.22742778, 0.15318571, 0.14045578, 0.1543631, 0.13271129, 0.13508919, 0.13140991, 0.14783373, 0.15767457, 0.15513828, 0.1553122, 0.14219347, 0.13958956, 0.10268273, 0.124118775, 0.12767245, 0.13248141, 0.13808915, 0.13166994, 0.12505008, 0.11253849, 0.12842964, 0.14734271, 0.12984684, 0.14804533, 0.13275814, 0.30982876]
AAAAA	SRRRDDRKKKDDDDDAELSSLSSSSSSSSK	0.0000	379780.6	[0.14136443, 0.16953997, 0.26315865, 0.21568063, 0.13758808, 0.20392312, 0.1987997, 0.17391275, 0.14208835, 0.14573258, 0.1871934, 0.14422397, 0.23250878, 0.21724927, 0.21437551, 0.20044756, 0.17911723, 0.149593, 0.20169377, 0.17628202, 0.16772373, 0.15744668, 0.20052117, 0.15512784, 0.20407508, 0.13276365, 0.1960932, 0.32661346, 0.18954112, 0.17194319]
AAAAA	DVYCYYYYPPPYYYYGFRPRRRR	0.0000	-37561.832	[0.2419891, 0.3680785, 0.34105796, 0.1292199, 0.5620244, 0.2786073, 0.26188976, 0.14739695, 0.16374455, 0.16572084, 0.12927413, 0.11078749, 0.10235891, 0.12636182, 0.11751035, 0.096022405, 0.121672556, 0.19747463, 0.16499923, 0.11875335, 0.24365018, 0.50002474, 0.39629322]
AAAAA	DLHYEEEEDEDDEDDDGRDDGEGGGGGDAD	0.0000	-35506.07	[0.607295, 0.37169635, 0.4769801, 0.15203246, 0.16768743, 0.6946748, 0.4371232, 0.2682434, 0.2602799, 0.14777237, 0.21320389, 0.2218839, 0.19296066, 0.18589664, 0.22472742, 0.17978068, 0.20415446, 0.18532121, 0.24066833, 0.1854439, 0.19921118, 0.17906643, 0.25699487, 0.2904765, 0.3481402, 0.43412387, 0.52475506, 0.2722133, 0.1729241, 0.5385613]
AAAAA	MLHPYMYYGYPPGCRRPRGGGYYYRRGGSR	0.0000	-111325.85	[0.4012516, 0.57137257, 0.77147865, 0.70089036, 0.24669501, 0.36657375, 0.2551391, 0.25885925, 0.13903488, 0.19879153, 0.13228804, 0.1394651, 0.15911332, 0.16231427, 0.1314556, 0.2889397, 0.17836006, 0.16925628, 0.14299873, 0.19700728, 0.18091926, 0.20477007, 0.245342, 0.23598143, 0.16892406, 0.2442116, 0.20225435, 0.17388165, 0.17026211, 0.26709336]
AAAAA	DLHPYEYYEEEEEDDRERGDDDYYYYYYVL	0.0000	-222528.69	[0.8169038, 0.5571705, 0.647805, 0.39941925, 0.15808849, 0.18755998, 0.14593084, 0.13150744, 0.12746073, 0.18219031, 0.13591045, 0.16595402, 0.22115599, 0.16951886, 0.1541024, 0.14608994, 0.123506695, 0.22008702, 0.16010493, 0.13287203, 0.18590535, 0.1864835, 0.27273682, 0.32814294, 0.52298796, 0.40600926, 0.29488215, 0.23548026, 0.25943214, 0.333976]
AAAAA	LCNVDHKPSNTKVDK	0.8637	0.8905497	[0.91120213, 0.9999431, 0.985016, 0.99331254, 1.0, 0.9999301, 0.99999315, 0.9999674, 0.99999875, 0.9999972, 0.9985019, 0.97082394, 0.99986935, 0.99999803, 0.9998357]
AAAAA	KCVDVHQPSNTKVDK	0.3186	0.8905497	[1.0, 0.9996397, 0.7792265, 0.65784687, 0.98481727, 0.99727046, 0.6354918, 0.99988145, 0.99982285, 0.9998596, 0.99887645, 0.99947494, 0.99879634, 0.99964684, 0.9999506]
AAAAA	GKPHPYPYPPPPRRRPSSSSYNYTYTR	0.0000	-115300.9	[0.4972661, 0.39805168, 0.3321427, 0.23299697, 0.25764093, 0.2483941, 0.21552688, 0.19068342, 0.1622084, 0.12701817, 0.17096724, 0.14162467, 0.21638773, 0.18743691, 0.19753844, 0.17955779, 0.15386926, 0.12644047, 0.29871324, 0.21397012, 0.21972054, 0.16637237, 0.24386781, 0.21356599, 0.17407584, 0.2527181, 0.33852786]
AAAAA	DTPCCYHGPGGGGPGRGGPGPPGGG	0.0000	211080.17	[0.35540593, 0.2968375, 0.28523704, 0.20791858, 0.26152167, 0.36977488, 0.49185064, 0.39204225, 0.25948322, 0.23064038, 0.38280398, 0.23103465, 0.18613847, 0.21948512, 0.19584867, 0.18339762, 0.20587605, 0.23543993, 0.31283918, 0.23839934, 0.26390848, 0.19057608, 0.2512998, 0.27495703, 0.35869908]
AAAAA	MKPYYGYPGGGGGGGGRGGGYRRRRRRRRR	0.0000	-156538.23	[0.4648189, 0.39060834, 0.41280606, 0.4557202, 0.47163957, 0.5131217, 0.36418778, 0.28561795, 0.17728904, 0.17115839, 0.16957033, 0.2170551, 0.2625115, 0.1860457, 0.13708839, 0.3076138, 0.30213082, 0.28388423, 0.32063785, 0.19078612, 0.33700722, 0.25843966, 0.29875138, 0.20293029, 0.32297963, 0.19127135, 0.29205647, 0.27282637, 0.35010076, 0.69854504]
AAAAA	CPCEHCDCCCDDDGCRQRPGDDD	0.0000	-15656.467	[0.21564841, 0.2478387, 0.23751944, 0.28246862, 0.24940266, 0.15735617, 0.1366499, 0.1640536, 0.1722063, 0.1513188, 0.23498459, 0.17389156, 0.12054824, 0.13140294, 0.1566367, 0.22193055, 0.14022979, 0.27556047, 0.1581733, 0.16922238, 0.1832647, 0.22321494, 0.19296226]
AAAAA	GVYCCEPPPPGGGGGGGGGGAGAGGGR	0.0000	234866.73	[0.41565436, 0.3256011, 0.37715152, 0.45308405, 0.17948462, 0.12831041, 0.20426233, 0.2319015, 0.17816411, 0.21418926, 0.1676751, 0.17852649, 0.15217225, 0.14370197, 0.16415301, 0.20967026, 0.20601825, 0.24628814, 0.20518544, 0.16359869, 0.1532126, 0.18361406, 0.24391177, 0.17235817, 0.18760112, 0.21917541, 0.14863373]
AAAAA	DLHCCTPPPPEDDEDRDRPDDDG	0.0000	83151.87	[0.66924006, 0.5854759, 0.351304, 0.24146968, 0.23975806, 0.21522182, 0.1613017, 0.228539, 0.4234296, 0.2539822, 0.20652984, 0.2791738, 0.20001006, 0.17788917, 0.19098338, 0.14122765, 0.11800055, 0.17461753, 0.18700838, 0.22505866, 0.37468225, 0.4589175, 0.303309]
AAAAA	MVHPYEGMPPGGGRGGGGGGGGGGGGGGGR	0.0000	202925.12	[0.45231077, 0.49634865, 0.4002926, 0.33856028, 0.30463547, 0.2746612, 0.60316575, 0.18959819, 0.6447687, 0.427179, 0.26598826, 0.23020282, 0.20444277, 0.17057575, 0.20131278, 0.26884738, 0.21207148, 0.21034846, 0.22510469, 0.27147368, 0.18279478, 0.2440893, 0.21665582, 0.27501088, 0.32714975, 0.31581607, 0.29748183, 0.5228073, 0.3978506, 0.66636306]
AAAAA	DLDYYEYDDPDDDDDDEGGPGEGG	0.0000	157698.66	[0.50249624, 0.6963631, 0.5210088, 0.34391543, 0.16611932, 0.18378751, 0.12755209, 0.108322784, 0.1521042, 0.15792532, 0.19562955, 0.16444764, 0.18803297, 0.17052224, 0.16709447, 0.15138267, 0.22189468, 0.15572672, 0.1652802, 0.14141937, 0.14430252, 0.14910741, 0.22461264, 0.22128248]
AAAAA	NHNHHVKPSNTKVDK	0.1833	-8.17295	[0.9900792, 0.49363756, 0.9643255, 0.8482621, 1.0, 0.46322352, 0.9900868, 0.99999815, 0.9999984, 0.9999953, 0.99978113, 0.9999847, 0.9999983, 0.99999934, 0.99999934]
AAAAA	NCNHNLKPSNTKVTK	0.1368	-3.4393716	[0.5784622, 0.9923915, 0.8325495, 0.63357514, 0.92320895, 0.5616769, 0.87184685, 0.99999636, 0.99998385, 0.99999326, 0.9999427, 0.9999663, 0.9995588, 1.0, 0.9999903]
AAAAA	GGGCGGGGGGGGGGGGG	0.0000	668696.1	[0.24014537, 0.38494056, 0.20637901, 0.23696202, 0.27521327, 0.23741378, 0.24848479, 0.20542915, 0.2332215, 0.23461092, 0.23333773, 0.2304707, 0.20098822, 0.22723413, 0.17681599, 0.22335437, 0.29384676]
AAAAA	REDDDEQDPPPDEDPED	0.0000	390037.03	[0.38533515, 0.13081846, 0.17762876, 0.14668827, 0.20720398, 0.23768362, 0.20519961, 0.16465788, 0.18703903, 0.20612474, 0.24563028, 0.19511274, 0.22172484, 0.16471684, 0.16342732, 0.19829012, 0.23994824]";
