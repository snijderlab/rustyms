#![allow(clippy::missing_panics_doc)]
use std::io::BufReader;

use crate::identification::{test_format, PLinkData, PLinkVersion};

#[test]
fn plink() {
    match test_format::<PLinkData>(
        BufReader::new(DATA_V2_3.as_bytes()),
        None,
        false,
        false,
        Some(PLinkVersion::V2_3),
    ) {
        Ok(n) => assert_eq!(n, 21),
        Err(e) => {
            println!("{e}");
            panic!("Failed identified peptides test");
        }
    }
}

const DATA_V2_3: &str = r"Order,Title,Charge,Precursor_MH,Peptide_Type,Peptide,Peptide_MH,Modifications,Refined_Score,SVM_Score,Score,E-value,Precursor_Mass_Error(Da),Precursor_Mass_Error(ppm),Target_Decoy,Q-value,Proteins,Protein_Type,FileID,isComplexSatisfied,isFilterIn
1,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.19136.19136.3.0.dta,3,1642.831563,2,IDPEKLSVNSHFMK(2)(5),1642.825678,Oxidation[M](13),199.200765,107.603000,1.856141e-047,1.000000e+000,0.005885,3.582243,2,0.000000,sp|Q9CR21|ACPM_MOUSE (26)(29)/,0,121,1,1
2,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.19593.19593.3.0.dta,3,1642.835591,2,IDPEKLSVNSHFMK(4)(5),1642.825678,Oxidation[M](13),175.123247,106.257000,7.131342e-047,1.000000e+000,0.009913,6.034116,2,0.000000,sp|Q9CR21|ACPM_MOUSE (28)(29)/,0,121,1,1
3,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.24008.24008.3.0.dta,3,1626.832670,2,IDPEKLSVNSHFMK(4)(5),1626.830764,null,175.761841,95.988800,2.053969e-042,1.000000e+000,0.001906,1.171603,2,0.000000,sp|Q9CR21|ACPM_MOUSE (28)(29)/,0,121,1,1
4,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.18408.18408.3.0.dta,3,2952.490051,2,AAPAPAAAPAAAPAAAPEPERPKEAEFDASK(20)(23),2952.484874,null,125.624997,90.802700,3.671880e-040,1.000000e+000,0.005177,1.753438,2,0.000000,sp|P09542|MYL3_MOUSE (39)(42)/,0,121,1,1
5,20240206_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F20.9089.9089.3.0.dta,3,2146.077031,2,RIKVEKPVVEMDGDEMTR(3)(5),2146.062997,Oxidation[M](11);Oxidation[M](16),162.571366,86.276000,3.394762e-038,1.000000e+000,0.014034,6.539417,2,0.000000,sp|P54071|IDHP_MOUSE (6)(8)/,0,138,1,1
6,20240206_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F20.10653.10653.3.0.dta,3,1726.830769,2,RKEEEHMIDWVEK(2)(3),1726.821652,Oxidation[M](7),218.639779,86.134100,3.912332e-038,1.000000e+000,0.009117,5.279642,2,0.000000,sp|Q9CQQ7|AT5F1_MOUSE (177)(178)/,0,138,1,1
7,20240206_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_KO3_F19.28486.28486.3.0.dta,3,1889.927362,2,EEEHMIDWVEKHVVK(10)(11),1889.921360,null,212.478290,84.415800,2.181142e-037,1.000000e+000,0.006002,3.175794,2,0.000000,sp|Q9CQQ7|AT5F1_MOUSE (187)(188)/,0,63,1,1
8,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.23369.23369.3.0.dta,3,1626.832913,2,IDPEKLSVNSHFMK(2)(5),1626.830764,null,156.477937,83.690600,4.504372e-037,1.000000e+000,0.002149,1.320973,2,0.000000,sp|Q9CR21|ACPM_MOUSE (26)(29)/,0,121,1,1
9,20240206_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_KO3_F19.29975.29975.4.0.dta,4,3026.492869,2,GGAEVQIFAPDVPQMHVIDHTKGEPSER(22)(24),3026.478740,null,148.182008,83.553700,5.165224e-037,1.000000e+000,0.014129,4.668462,2,0.000000,sp|Q9D172|GAL3A_MOUSE (53)(55)/,0,63,1,1
10,20240207_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F24_4uL.23744.23744.4.0.dta,4,2174.125137,2,RKEEEHMIDWVEKHVVK(12)(13),2174.117417,null,216.982238,82.968900,9.269676e-037,1.000000e+000,0.007720,3.550866,2,0.000000,sp|Q9CQQ7|AT5F1_MOUSE (187)(188)/,0,144,1,1
11,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.18398.18398.3.0.dta,3,2952.490347,2,AAPAPAAAPAAAPAAAPEPERPKEAEFDASK(20)(23),2952.484874,null,109.558310,81.783900,3.031821e-036,1.000000e+000,0.005473,1.853693,2,0.000000,sp|P09542|MYL3_MOUSE (39)(42)/,0,121,1,1
12,20240207_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F24_4uL.20003.20003.3.0.dta,3,1662.887326,2,HVVFGHVKEGMDVVK(8)(9),1662.878380,null,222.355045,78.695900,6.649743e-035,1.000000e+000,0.008946,5.379828,2,0.000000,sp|Q99KR7|PPIF_MOUSE (145)(146)/,0,144,1,1
13,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F16.18547.18547.3.0.dta,3,2952.487542,2,AAPAPAAAPAAAPAAAPEPERPKEAEFDASK(20)(23),2952.484874,null,116.750042,77.717700,1.768609e-034,1.000000e+000,0.002668,0.903646,2,0.000000,sp|P09542|MYL3_MOUSE (39)(42)/,0,124,1,1
14,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F16.24114.24114.3.0.dta,3,1626.832691,2,IDPEKLSVNSHFMK(4)(5),1626.830764,null,145.915590,74.962900,2.779881e-033,1.000000e+000,0.001927,1.184512,2,0.000000,sp|Q9CR21|ACPM_MOUSE (28)(29)/,0,124,1,1
15,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F16.18669.18669.3.0.dta,3,2952.494587,2,AAPAPAAAPAAAPAAAPEPERPKEAEFDASK(23)(24),2952.484874,null,100.707043,74.939100,2.846836e-033,1.000000e+000,0.009713,3.289771,2,0.000000,sp|P09542|MYL3_MOUSE (42)(43)/,0,121,1,1
16,20240206_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_KO3_F19.11768.11768.3.0.dta,3,2130.073631,2,RIKVEKPVVEMDGDEMTR(3)(5),2130.068083,Oxidation[M](11),127.846755,74.027400,7.084491e-033,1.000000e+000,0.005548,2.604612,2,0.000000,sp|P54071|IDHP_MOUSE (6)(8)/,0,63,1,1
17,20240207_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F24_4uL.28725.28725.3.0.dta,3,1759.009257,2,GQDIKVPPPLPQFGRK(3)(5),1759.001266,null,134.622296,73.442100,1.272041e-032,1.000000e+000,0.007991,4.542919,2,0.000000,sp|Q6P8J7|KCRS_MOUSE (367)(369)/,0,144,1,1
18,20240205_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F16.19290.19290.3.0.dta,3,1642.831606,2,IDPEKLSVNSHFMK(2)(5),1642.825678,Oxidation[M](13),206.031048,73.386100,1.345308e-032,1.000000e+000,0.005928,3.608417,2,0.000000,sp|Q9CR21|ACPM_MOUSE (26)(29)/,0,124,1,1
19,20240203_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT1_F13.9803.9803.3.0.dta,3,1608.899475,3,VGSPPLEK(7)-SAPAVQTK(1),1608.895471,null,164.404474,73.209800,1.604678e-032,1.000000e+000,0.004004,2.488664,2,0.000000,sp|Q99JY0|ECHB_MOUSE (382)-sp|Q99JY0|ECHB_MOUSE (1)/,1,105,1,1
898,20240129_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT2_F1.30643.30643.2.0.dta,2,978.530764,1,GDQALSFLK(2),978.525427,null,233.969839,32.589600,7.022901e-015,1.000000e+000,0.005337,5.454125,2,0.000000,sp|P48962|ADT1_MOUSE (3)/,0,76,1,1
932,20240129_EX3_UM5_perez044_SA_EXT00_MitoDMTMM_WT3_F2.12541.12541.3.0.dta,3,2382.956691,0,MTLSDPSEMDELMSEEAYEK,2382.950846,Oxidation[M](1);Oxidation[M](9);Oxidation[M](13),80.316758,32.287200,9.502704e-015,1.000000e+000,0.005845,2.452841,2,0.000000,sp|Q91WK5|GCSH_MOUSE /,0,80,1,1";
